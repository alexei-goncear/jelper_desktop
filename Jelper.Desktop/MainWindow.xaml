<Window x:Class="Jelper.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Jelper Image Helper"
        Icon="jelper.ico"
        Height="720"
        Width="1100"
        MinHeight="640"
        MinWidth="960"
        Background="#0D0F14"
        Foreground="#F5F5F5">
    <Window.Resources>
        <SolidColorBrush x:Key="CardBrush" Color="#181C23" />
        <SolidColorBrush x:Key="AccentBrush" Color="#3EA6FF" />
        <SolidColorBrush x:Key="BorderBrushColor" Color="#2A2F3A" />

        <Style TargetType="Button">
            <Setter Property="Background" Value="#232833" />
            <Setter Property="Foreground" Value="#F5F5F5" />
            <Setter Property="BorderBrush" Value="#343B48" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="6"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2E3543" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#1F242E" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#1C212B" />
            <Setter Property="Foreground" Value="#F5F5F5" />
            <Setter Property="BorderBrush" Value="#2E3543" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="8,4" />
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#1C212B" />
            <Setter Property="Foreground" Value="#F5F5F5" />
        </Style>

        <Style x:Key="ConversionComboBoxItemStyle" TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="Black" />
        </Style>

        <Style x:Key="IconActionButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Padding" Value="16" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="10"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid x:Name="LayoutRoot" Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <StackPanel>
                <TextBlock Text="Jelper — Julia-Helper :))) Люблю целую, масик :*" FontSize="24" FontWeight="Bold" />
                <TextBlock Text="Выберите папку с картинками, затем используйте нужный инструмент" Margin="0,6,0,0" Foreground="#B0B4C1" />
            </StackPanel>

            <Border Grid.Row="1" Background="{StaticResource CardBrush}" CornerRadius="10" Padding="16" Margin="0,18,0,0" BorderBrush="{StaticResource BorderBrushColor}" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel>
                        <TextBlock Text="Папка с файлами" FontWeight="SemiBold" />
                        <TextBox x:Name="ImagesFolderTextBox" Margin="0,6,0,0" MinWidth="320" />
                    </StackPanel>
                    <Button x:Name="BrowseFolderButton" Grid.Column="1" Content="Выбрать папку" Margin="16,18,0,0" Click="BrowseFolderButton_OnClick" />
                </Grid>
            </Border>

            <Border Grid.Row="2" Background="{StaticResource CardBrush}" CornerRadius="10" Padding="16" Margin="0,20,0,0" BorderBrush="{StaticResource BorderBrushColor}" BorderThickness="1">
                <UniformGrid x:Name="ActionsPanel" Columns="4" Rows="1" Margin="0,4,0,0">
                    <Button Style="{StaticResource IconActionButtonStyle}" Tag="Convert" Click="ActionShortcut_OnClick" ToolTip="Конвертация WEBP в PNG">
                        <StackPanel>
                            <TextBlock Text="&#xE77B;" FontFamily="Segoe MDL2 Assets" FontSize="32" HorizontalAlignment="Center" />
                            <TextBlock Text="Конвертация" HorizontalAlignment="Center" Margin="0,6,0,0" />
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource IconActionButtonStyle}" Tag="Trim" Click="ActionShortcut_OnClick" ToolTip="Удалить нижний водяной знак">
                        <StackPanel>
                            <TextBlock Text="&#xE8FD;" FontFamily="Segoe MDL2 Assets" FontSize="32" HorizontalAlignment="Center" />
                            <TextBlock Text="Обрезать водяной знак" HorizontalAlignment="Center" Margin="0,6,0,0" />
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource IconActionButtonStyle}" Tag="Resize" Click="ActionShortcut_OnClick" ToolTip="Принудительное изменение размера">
                        <StackPanel>
                            <TextBlock Text="&#xE8D7;" FontFamily="Segoe MDL2 Assets" FontSize="32" HorizontalAlignment="Center" />
                            <TextBlock Text="Изменить размер" HorizontalAlignment="Center" Margin="0,6,0,0" />
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource IconActionButtonStyle}" Tag="Watermark" Click="ActionShortcut_OnClick" ToolTip="Изменить размер и добавить водяной знак">
                        <StackPanel>
                            <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="32" HorizontalAlignment="Center" />
                            <TextBlock Text="Размер + водяной знак" TextAlignment="Center" Margin="0,6,0,0" />
                        </StackPanel>
                    </Button>
                </UniformGrid>
            </Border>

            <Border x:Name="DetailsCard" Grid.Row="3" Background="{StaticResource CardBrush}" CornerRadius="12" Padding="20" Margin="0,20,0,0" BorderBrush="{StaticResource BorderBrushColor}" BorderThickness="1" Visibility="Collapsed">
                <StackPanel>
                    <Grid HorizontalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock x:Name="DetailsHeader" FontSize="20" FontWeight="Bold" VerticalAlignment="Center" />
                        <Button Content="Закрыть" Width="110" Grid.Column="1" HorizontalAlignment="Right" Click="HideDetailsButton_OnClick" />
                    </Grid>
                    <Separator Margin="0,12,0,16" />

                    <Grid>
                        <Grid x:Name="ConvertForm" Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="Конвертация файлов между поддерживаемыми форматами. Исходники удаляются после успешного преобразования." TextWrapping="Wrap" Foreground="#B0B4C1" />
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <StackPanel Width="160">
                                        <TextBlock Text="Исходный формат" />
                                        <ComboBox x:Name="SourceFormatComboBox"
                                                  Margin="0,4,0,0"
                                                  Foreground="Black"
                                                  SelectionChanged="SourceFormatComboBox_OnSelectionChanged"
                                                  ItemContainerStyle="{StaticResource ConversionComboBoxItemStyle}" />
                                    </StackPanel>
                                    <StackPanel Width="160" Margin="20,0,0,0">
                                        <TextBlock Text="Целевой формат" />
                                        <ComboBox x:Name="TargetFormatComboBox"
                                                  Margin="0,4,0,0"
                                                  Foreground="Black"
                                                  ItemContainerStyle="{StaticResource ConversionComboBoxItemStyle}" />
                                    </StackPanel>
                                </StackPanel>
                                <Button x:Name="ConvertButton" Content="Запустить конвертацию" Height="40" Margin="0,16,0,0" Click="ConvertButton_OnClick" />
                            </StackPanel>
                        </Grid>

                        <Grid x:Name="TrimForm" Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="Удаление горизонтальной полосы (водяного знака) снизу PNG/JPG файлов." TextWrapping="Wrap" Foreground="#B0B4C1" />
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <TextBlock Text="Пиксели" VerticalAlignment="Center" />
                                    <TextBox x:Name="PixelsToTrimTextBox"
                                             Width="140"
                                             Margin="12,0,0,0"
                                             VerticalContentAlignment="Center"
                                             PreviewTextInput="NumericTextBox_OnPreviewTextInput"
                                             DataObject.Pasting="NumericTextBox_OnPaste" />
                                </StackPanel>
                                <Button Content="Удалить полосу" Height="40" Margin="0,16,0,0" Click="TrimButton_OnClick" />
                            </StackPanel>
                        </Grid>

                        <Grid x:Name="ResizeForm" Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="Принудительное изменение размера PNG/JPG файлов (пропорции будут растянуты)." TextWrapping="Wrap" Foreground="#B0B4C1" />
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <StackPanel Width="160">
                                        <TextBlock Text="Ширина (px)" />
                                        <TextBox x:Name="ResizeWidthTextBox"
                                                 Margin="0,4,0,0"
                                                 VerticalContentAlignment="Center"
                                                 PreviewTextInput="NumericTextBox_OnPreviewTextInput"
                                                 DataObject.Pasting="NumericTextBox_OnPaste" />
                                    </StackPanel>
                                    <StackPanel Width="160" Margin="20,0,0,0">
                                        <TextBlock Text="Высота (px)" />
                                        <TextBox x:Name="ResizeHeightTextBox"
                                                 Margin="0,4,0,0"
                                                 VerticalContentAlignment="Center"
                                                 PreviewTextInput="NumericTextBox_OnPreviewTextInput"
                                                 DataObject.Pasting="NumericTextBox_OnPaste" />
                                    </StackPanel>
                                </StackPanel>
                                <Button Content="Изменить размер" Height="40" Margin="0,16,0,0" Click="ResizeButton_OnClick" />
                            </StackPanel>
                        </Grid>

                        <Grid x:Name="WatermarkForm" Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock Text="Изменение размера и добавление выбранного PNG водяного знака." TextWrapping="Wrap" Foreground="#B0B4C1" />
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <StackPanel Width="160">
                                        <TextBlock Text="Ширина (px)" />
                                        <TextBox x:Name="WatermarkWidthTextBox"
                                                 Margin="0,4,0,0"
                                                 VerticalContentAlignment="Center"
                                                 PreviewTextInput="NumericTextBox_OnPreviewTextInput"
                                                 DataObject.Pasting="NumericTextBox_OnPaste" />
                                    </StackPanel>
                                    <StackPanel Width="160" Margin="20,0,0,0">
                                        <TextBlock Text="Высота (px)" />
                                        <TextBox x:Name="WatermarkHeightTextBox"
                                                 Margin="0,4,0,0"
                                                 VerticalContentAlignment="Center"
                                                 PreviewTextInput="NumericTextBox_OnPreviewTextInput"
                                                 DataObject.Pasting="NumericTextBox_OnPaste" />
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
                                    <TextBox x:Name="WatermarkPathTextBox" IsReadOnly="True" Width="240" />
                                    <Button Content="Выбрать PNG" Width="150" Margin="12,0,0,0" Click="ChooseWatermarkButton_OnClick" />
                                </StackPanel>
                                <Button Content="Изменить размер и нанести" Height="40" Margin="0,16,0,0" Click="WatermarkButton_OnClick" />
                            </StackPanel>
                        </Grid>
                    </Grid>

                    <Border x:Name="ProgressPanel" Background="#11141C" CornerRadius="10" Padding="16" Margin="0,20,0,0" BorderBrush="{StaticResource BorderBrushColor}" BorderThickness="1" Visibility="Collapsed">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Stretch">
                                <StackPanel>
                                    <TextBlock Text="Выполнение операции" FontSize="16" FontWeight="Bold" />
                                    <TextBlock x:Name="CurrentOperationText" Foreground="#B0B4C1" Margin="0,4,0,0" />
                                </StackPanel>
                                <Button x:Name="CancelOperationButton" Content="Отменить" Margin="20,0,0,0" Width="120" HorizontalAlignment="Right" Click="CancelOperationButton_OnClick" />
                            </StackPanel>
                            <TextBlock x:Name="ProgressSummaryText" FontWeight="SemiBold" Margin="0,12,0,0" />
                            <TextBlock x:Name="EtaText" Foreground="#B0B4C1" Margin="0,4,0,0" />
                            <ProgressBar x:Name="OverallProgressBar" Height="16" Margin="0,12,0,12" Minimum="0" Maximum="1" />
                            <Border BorderThickness="1" BorderBrush="{StaticResource BorderBrushColor}" CornerRadius="6">
                                <ListView x:Name="ProcessingFilesList" Background="#0D0F14" BorderThickness="0" Foreground="#F5F5F5" Height="220" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <ListView.Resources>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="Background" Value="#0D0F14" />
                                            <Setter Property="Foreground" Value="#F5F5F5" />
                                            <Setter Property="Padding" Value="8,4" />
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="BorderBrush" Value="#2A2F3A" />
                                            <Setter Property="BorderThickness" Value="0,0,0,1" />
                                        </Style>
                                    </ListView.Resources>
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Background" Value="#0D0F14" />
                                            <Setter Property="Foreground" Value="#F5F5F5" />
                                            <Setter Property="BorderThickness" Value="0,0,0,1" />
                                            <Setter Property="BorderBrush" Value="#1F232C" />
                                            <Setter Property="Padding" Value="8,4" />
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#151922" />
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#1E2735" />
                                                    <Setter Property="BorderBrush" Value="#3EA6FF" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="Файл" Width="360">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding FileName}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Статус" Width="160">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding StatusText}" Foreground="{Binding StatusBrush}" FontWeight="SemiBold" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <StatusBar Grid.Row="4" Margin="0,24,0,0" Background="#0D0F14" Foreground="#F5F5F5">
                <StatusBarItem>
                    <TextBlock x:Name="StatusTextBlock" Text="Готов" />
                </StatusBarItem>
                <StatusBarItem>
                    <ProgressBar x:Name="ProgressIndicator" Width="180" Height="14" Visibility="Collapsed" IsIndeterminate="True" />
                </StatusBarItem>
                <StatusBarItem HorizontalAlignment="Right">
                    <Button x:Name="ToggleLogsButton" Content="Логи" Click="ShowLogsButton_OnClick" />
                </StatusBarItem>
            </StatusBar>
        </Grid>

        <Border x:Name="LogsOverlay" Background="#AA000000" Visibility="Collapsed">
            <Border Background="#141821" CornerRadius="12" Padding="16" Width="600" Height="380" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,40,40,0" BorderBrush="{StaticResource BorderBrushColor}" BorderThickness="1">
                <DockPanel>
                    <DockPanel DockPanel.Dock="Top" LastChildFill="False">
                        <TextBlock Text="История операций" FontSize="16" FontWeight="Bold" VerticalAlignment="Center" DockPanel.Dock="Left" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                            <Button Content="Очистить" Margin="0,0,8,0" Click="ClearLogButton_OnClick" />
                            <Button Content="Закрыть" Click="HideLogsButton_OnClick" />
                        </StackPanel>
                    </DockPanel>
                    <TextBox x:Name="LogTextBox"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             IsReadOnly="True"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             FontFamily="Consolas"
                             Margin="0,12,0,0" />
                </DockPanel>
            </Border>
        </Border>
    </Grid>
</Window>
